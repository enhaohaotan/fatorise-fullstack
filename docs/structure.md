# API Contract — v0

## 1. Overview

- **Base URL (local):** `http://localhost:3000`
- **Content-Type:** `application/json`
- **Character encoding:** UTF-8
- **ID format:** UUID (string)
- **Time format:** ISO 8601 string (e.g. `2025-12-23T12:34:56.000Z`)

## 2. Conventions

- All responses are wrapped in `{ "data": ... }` for success
- All errors are wrapped in `{ "error": { "code": "...", "message": "..." } }`
- Field names use camelCase
- Timestamps are auto-generated by the server

### 2.1 HTTP Status Codes

| Status | Meaning                        |
| ------ | ------------------------------ |
| 200    | OK - Request succeeded         |
| 201    | Created - Resource created     |
| 400    | Bad Request - Validation error |
| 404    | Not Found - Resource not found |
| 500    | Internal Server Error          |

### 2.2 Error Response

```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Title is required"
  }
}
```

**Error Codes:**

- `VALIDATION_ERROR` - Invalid request body
- `NOT_FOUND` - Resource does not exist
- `INTERNAL_ERROR` - Server error

## 3. Data Model

### 3.1 User

```json
{
  "id": "a1b2c3d4-5e6f-7890-abcd-ef1234567890",
  "email": "user@example.com",
  "password": "hashed_password",
  "name": "John Doe",
  "createdAt": "2025-12-23T12:34:56.000Z",
  "updatedAt": "2025-12-23T12:34:56.000Z"
}
```

| Field     | Type              | Required | Description                         |
| --------- | ----------------- | -------- | ----------------------------------- |
| id        | string (UUID)     | auto     | Unique identifier                   |
| email     | string            | ✅       | Unique email address                |
| password  | string            | ✅       | Hashed password (6-127 chars)       |
| name      | string \| null    | ❌       | Optional display name (1-255 chars) |
| createdAt | string (ISO 8601) | auto     | Creation timestamp                  |
| updatedAt | string (ISO 8601) | auto     | Last update timestamp               |

### 3.2 Task

```json
{
  "id": "7d0c1c4d-1a9e-4f5e-9d3a-3e7a2b6d4a1f",
  "title": "Buy milk",
  "description": "2% or oat",
  "completed": false,
  "userId": "a1b2c3d4-5e6f-7890-abcd-ef1234567890",
  "createdAt": "2025-12-23T12:34:56.000Z",
  "updatedAt": "2025-12-23T12:34:56.000Z"
}
```

| Field       | Type              | Required | Description                           |
| ----------- | ----------------- | -------- | ------------------------------------- |
| id          | string (UUID)     | auto     | Unique identifier                     |
| title       | string            | ✅       | Task title (1-255 chars)              |
| description | string \| null    | ❌       | Optional description (max 1000 chars) |
| completed   | boolean           | ❌       | Default: false                        |
| userId      | string (UUID)     | ✅       | Owner user ID                         |
| createdAt   | string (ISO 8601) | auto     | Creation timestamp                    |
| updatedAt   | string (ISO 8601) | auto     | Last update timestamp                 |

## 4. Endpoints

### 4.1 Health Check

`GET /health`

**Response:** `200 OK`

```json
{
  "data": {
    "ok": true
  }
}
```

### 4.2 View Tasks

`GET /tasks`

**Description:** Returns tasks sorted by createdAt descending.

**Response:** `200 OK`

```json
{
  "data": [
    {
      "id": "7d0c1c4d-1a9e-4f5e-9d3a-3e7a2b6d4a1f",
      "title": "Buy milk",
      "description": null,
      "completed": false,
      "createdAt": "2025-12-23T12:34:56.000Z",
      "updatedAt": "2025-12-23T12:34:56.000Z"
    }
  ]
}
```

### 4.3 Create Task

`POST /tasks`

**Request Body:**

```json
{
  "title": "Buy milk",
  "description": "2% or oat"
}
```

| Field       | Type   | Required | Description                           |
| ----------- | ------ | -------- | ------------------------------------- |
| title       | string | ✅       | Task title (1-255 chars)              |
| description | string | ❌       | Optional description (max 1000 chars) |

**Response:** `201 Created`

```json
{
  "data": {
    "id": "7d0c1c4d-1a9e-4f5e-9d3a-3e7a2b6d4a1f",
    "title": "Buy milk",
    "description": "2% or oat",
    "completed": false,
    "createdAt": "2025-12-23T12:34:56.000Z",
    "updatedAt": "2025-12-23T12:34:56.000Z"
  }
}
```

**Errors:**

- `400` - Title is required or invalid

### 4.4 Update Task

`PATCH /tasks/{id}`

**Path Parameters:**

- `id` - Task UUID

**Request Body:**

```json
{
  "title": "Buy oat milk",
  "description": "From Whole Foods",
  "completed": true
}
```

| Field       | Type           | Required | Description                      |
| ----------- | -------------- | -------- | -------------------------------- |
| title       | string         | ❌       | New title (1-255 chars)          |
| description | string \| null | ❌       | New description (max 1000 chars) |
| completed   | boolean        | ❌       | Completion status                |

> **Note:** At least one field must be provided.

**Response:** `200 OK`

```json
{
  "data": {
    "id": "7d0c1c4d-1a9e-4f5e-9d3a-3e7a2b6d4a1f",
    "title": "Buy oat milk",
    "description": "From Whole Foods",
    "completed": true,
    "createdAt": "2025-12-23T12:34:56.000Z",
    "updatedAt": "2025-12-23T13:00:00.000Z"
  }
}
```

**Errors:**

- `400` - Invalid request body
- `404` - Task not found

### 4.5 Delete Task

`DELETE /tasks/{id}`

**Path Parameters:**

- `id` - Task UUID

**Response:** `200 OK`

```json
{
  "data": {
    "id": "7d0c1c4d-1a9e-4f5e-9d3a-3e7a2b6d4a1f"
  }
}
```

**Errors:**

- `404` - Task not found

## 5. Auth Endpoints

### 5.1 Sign Up

`POST /auth/signup`

**Request Body:**

```json
{
  "email": "user@example.com",
  "password": "yourpassword",
  "name": "John Doe"
}
```

| Field    | Type   | Required | Description                |
| -------- | ------ | -------- | -------------------------- |
| email    | string | ✅       | Email address              |
| password | string | ✅       | Password (6-127 chars)     |
| name     | string | ❌       | Display name (1-255 chars) |

**Response:** `201 Created`

```json
{
  "data": {
    "id": "a1b2c3d4-5e6f-7890-abcd-ef1234567890",
    "email": "user@example.com",
    "name": "John Doe",
    "createdAt": "2025-12-23T12:34:56.000Z",
    "updatedAt": "2025-12-23T12:34:56.000Z"
  }
}
```

**Errors:**

- `400` - Validation error (invalid email, password too short/long, etc.)

### 5.2 Sign In

`POST /auth/signin`

**Request Body:**

```json
{
  "email": "user@example.com",
  "password": "yourpassword"
}
```

| Field    | Type   | Required | Description            |
| -------- | ------ | -------- | ---------------------- |
| email    | string | ✅       | Email address          |
| password | string | ✅       | Password (6-127 chars) |

**Response:** `200 OK`

```json
{
  "data": {
    "id": "a1b2c3d4-5e6f-7890-abcd-ef1234567890",
    "email": "user@example.com",
    "name": "John Doe",
    "createdAt": "2025-12-23T12:34:56.000Z",
    "updatedAt": "2025-12-23T12:34:56.000Z"
  }
}
```

**Errors:**

- `400` - Validation error (invalid email, password too short/long)
- `401` - Invalid credentials
